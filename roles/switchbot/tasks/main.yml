---
- name: Install additional packages
  apt:
    name:
      - jq
  tags: [switchbot, package]

- name: Copy switchbot.sh
  template:
    src: switchbot.sh.j2
    dest: /usr/lib/zabbix/agentscripts/switchbot.sh
    mode: 0755
    variable_start_string: "[%"
    variable_end_string: "%]"
  tags: [switchbot]

- name: Copy switchbot.conf
  copy:
    src: switchbot.conf
    dest: /etc/zabbix/zabbix_agentd.d
  notify: Restart zabbix-agent
  tags: [switchbot]