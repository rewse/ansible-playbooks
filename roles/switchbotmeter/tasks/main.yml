---
- name: Install additional packages
  apt:
    name:
      - jq
      - mosquitto-clients
  tags: [switchbotmeter, package]

- name: Copy switchbotmeter
  template:
    src: switchbotmeter.j2
    dest: /usr/local/bin/switchbotmeter
    mode: 0755
    variable_start_string: "[%"
    variable_end_string: "%]"
  tags: [switchbotmeter]

- name: Copy switchbotmeter2mqtt
  copy:
    src: switchbotmeter2mqtt
    dest: /usr/local/bin
    mode: 0755
  tags: [switchbotmeter]

- name: Copy switchbotmeter2mqtt.cron
  copy:
    src: switchbotmeter2mqtt.cron
    dest: /etc/cron.d/switchbotmeter2mqtt
  tags: [switchbotmeter]