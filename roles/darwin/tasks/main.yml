---
- name: Tap brew repos
  homebrew_tap:
    name: "{{ item }}"
  with_items:
    - homebrew/cask
    - homebrew/cask-drivers
    - homebrew/cask-fonts
    - sanemat/font
  tags: [darwin, package, homebrew, ricty]

- name: Install packages by homebrew
  homebrew:
    name: 
      - ansible
      - awscli
      - gh
      - fontforge
      - fping
      - jq
      - mas
      - node
      - php
      - pv
      - pwgen
      - python3
      - reattach-to-user-namespace
      - switchaudio-osx
      - telnet
      - source-highlight
      - svn
      - tmux
      - tree
      - watch
    update_homebrew: yes
  tags: [darwin, package, homebrew]

- name: Install ricty
  homebrew:
    name: ricty
    update_homebrew: yes
    install_options: with-powerline
  tags: [darwin, package, homebrew, ricty]

- name: Create Ricty dir
  file:
    path: /Library/Fonts/Ricty
    state: directory
    mode: 0755
  tags: [darwin, ricty]

- name: Copy ricty
  copy:
    src: /opt/homebrew/Cellar/ricty/{{ ricty_version }}/share/fonts/{{item}}
    dest: /Library/Fonts/Ricty
    remote_src: yes
  with_items:
    - "Ricty Bold for Powerline.ttf"
    - "Ricty Discord Bold for Powerline.ttf"
    - "Ricty Discord Regular for Powerline.ttf"
    - "Ricty Regular for Powerline.ttf"
    - Ricty-Bold.ttf
    - Ricty-Regular.ttf
    - RictyDiscord-Bold.ttf
    - RictyDiscord-Regular.ttf
  tags: [darwin, ricty]

- name: Copy fix_ricty.pe
  copy:
    src: fix_ricty.pe
    dest: /tmp
    mode: 0755
  tags: [darwin, ricty]

# See also <https://qiita.com/uKLEina/items/ff0877871fc425952b92>
- name: Fix Ricty
  command: /tmp/fix_ricty.pe "/Library/Fonts/Ricty/{{ item }}"
  with_items:
    - "Ricty Bold for Powerline.ttf"
    - "Ricty Discord Bold for Powerline.ttf"
    - "Ricty Discord Regular for Powerline.ttf"
    - "Ricty Regular for Powerline.ttf"
    - Ricty-Bold.ttf
    - Ricty-Regular.ttf
    - RictyDiscord-Bold.ttf
    - RictyDiscord-Regular.ttf
  tags: [darwin, ricty]

- name: Install packages by homebrew_cask
  homebrew_cask:
    name: 
      - 1password
      - adobe-creative-cloud
      - alfred
      - amazon-chime
      - amazon-workspaces
      - appcleaner
      - atok
      - authy
      - bartender
      - calibre
      - chromedriver
      - cinebench
      - corretto
      - cyberduck
      - deepl
      - evernote
      - firefox
      - fantastical
      - font-hackgen
      - font-new-york
      - font-sf-compact
      - font-sf-mono
      - font-sf-mono-for-powerline
      - font-sf-pro
      - font-source-sans-pro
      - font-source-serif-pro
      - geekbench
      - gnucash
      - google-chrome
      - grandperspective
      - handbrake
      - hhkb-keymap-tool
      - istat-menus
      - iterm2
      - jabra-direct
      - karabiner-elements
      - keyboard-maestro
      - kindle
      - logitech-unifying
      - macvim
      - messenger
      - microsoft-edge
      - monitorcontrol
      - nextcloud
      - obsidian
      - prowritingaid
      - remember-the-milk
      - slack
      - sony-ps-remote-play
      - steermouse
      - tigervnc-viewer
      - visual-studio-code
      - vlc
      - wireshark
    update_homebrew: yes
  tags: [darwin, package, cask]

- name: Install packages by mas
  command: mas install {{item}}
  with_items:
    - 1512372293  # 3DMark Wild Life Benchmark
    - 545519333   # Amazon Prime Video
    - 878419553   # Amazon WorkDocs
    - 1168254295  # AmorphousDiskMark
    - 417375580   # BetterSnapTool
    - 425264550   # Blackmagic Disk Speed Test
    - 1044629456  # GFXBench Metal
    - 1099568401  # Home Assistant
    - 539883307   # LINE
    - 1480068668  # Messenger
    - 1295203466  # Microsoft Remote Desktop
    - 981430153   # Online
    - 445189367   # PopClip
    - 1449412482  # Reeder 4
    - 1429033973  # RunCat
    - 1187772509  # stts
    - 899247664   # TestFlight
    - 425424353   # The Unarchiver
    - 1482454543  # Twitter
    - 1385561119  # Ubiquiti WiFiman
    - 494803304   # WiFi Explorer
    - 1451685025  # WireGuard
    - 1380563956  # 辞書 by 物書堂
    - 599799247   # そら案内
  tags: [darwin, package, mas]

- name: Install packages by pip
  pip:
    name:
      - beautifulsoup4
      - jupyter
      - pip-review
      - powerline-status
      - requests
      - selenium
    state: latest
    executable: pip3
  tags: [darwin, package, pip]

# - name: Install rest of the apps
#   install_yourself:
#     - https://www.blackmagicdesign.com/jp/products/davinciresolve/  # DaVinci Resolve
#     - https://www.ireasoning.com/mibbrowser.shtml                   # MIB Browser
#     - https://www.obsbot.com/jp/download?tab=obsbot-meet            # OBSBOT MeetCam
#     - https://jp.steelseries.com/gg                                 # SteelSeries GG
#     - https://www.xencelabs.com/support/download-drivers/           # Xencelabs Driver
