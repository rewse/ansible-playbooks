---
- name: install packages by homebrew
  homebrew:
    name: 
      - git
      - fontforge
      - mysql
      - postgresql
      - python3
      - pwgen
      - reattach-to-user-namespace
      - telnet
      - source-highlight
      - tmux
      - tree
    state: latest
    update_homebrew: yes
  tags: [darwin, package, homebrew]

- name: tap brew repos
  homebrew_tap:
    name: sanemat/font
  tags: [darwin, package, homebrew, ricty]

- name: install ricty
  homebrew:
    name: ricty
    state: latest
    update_homebrew: yes
    install_options: with-powerline
  tags: [darwin, package, homebrew, ricty]

- name: create Ricty dir
  file:
    path: /Library/Fonts/Ricty
    state: directory
    mode: 0755
  tags: [darwin, ricty]

- name: copy ricty
  copy:
    src: /usr/local/Cellar/ricty/{{ ricty_version }}/share/fonts/{{item}}
    dest: /Library/Fonts/Ricty
    remote_src: yes
  with_items:
    - "Ricty Bold for Powerline.ttf"
    - "Ricty Discord Bold for Powerline.ttf"
    - "Ricty Discord Regular for Powerline.ttf"
    - "Ricty Regular for Powerline.ttf"
    - Ricty-Bold.ttf
    - Ricty-Regular.ttf
    - RictyDiscord-Bold.ttf
    - RictyDiscord-Regular.ttf
  tags: [darwin, ricty]

- name: Copy fix_ricty.pe
  copy:
    src: fix_ricty.pe
    dest: /tmp
    mode: 0755
  tags: [darwin, ricty]

# See also <https://qiita.com/uKLEina/items/ff0877871fc425952b92>
- name: Fix Ricty
  command: /tmp/fix_ricty.pe "/Library/Fonts/Ricty/{{ item }}"
  with_items:
    - "Ricty Bold for Powerline.ttf"
    - "Ricty Discord Bold for Powerline.ttf"
    - "Ricty Discord Regular for Powerline.ttf"
    - "Ricty Regular for Powerline.ttf"
    - Ricty-Bold.ttf
    - Ricty-Regular.ttf
    - RictyDiscord-Bold.ttf
    - RictyDiscord-Regular.ttf
  tags: [darwin, ricty]

- name: install packages by pip
  pip:
    name:
      - ansible
      - pip-review
      - powerline-status
    state: latest
    executable: pip3
  tags: [darwin, package, pip]
