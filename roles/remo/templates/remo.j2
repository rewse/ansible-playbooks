#!/usr/bin/env bash

set -euo pipefail
trap 'exit 1' 1 2 3 15

readonly token=[% remo_token %]
readonly category=$1

device_id=$2

if [ ! "$device_id" ]; then
    read -p "Device ID: " device_id
fi

# {{{ send_signal()

send_signal() {
    curl -X POST -H """Authorization: Bearer $token""" \
        https://api.nature.global/1/signals/$device_id/send
        > /dev/null 2>&1

    retval=$?
}

# }}}
# {{{ Main

if [ "$category" == "signal" ]; then
    send_signal
else
    echo "<ERROR> $category is not supported. Only siganl is supported." >&2
    exit 1
fi

exit $retval

# }}}
