- id: automation.alarm_internet_speed_is_too_slow
  alias: "ALARM: Internet Speed is Too Slow"
  trigger:
    - platform: numeric_state
      entity_id: sensor.fast_com_download
      below: 1
  condition:
    - condition: numeric_state
      entity_id: sensor.speedtest_download
      below: 1
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: Internet Speed is Too Slow
        data:
          url: /lovelace-machines/machines
    - delay:
        hours: 0
        minutes: 0
        seconds: 10
        milliseconds: 0
    - service: script.restart_zulu
  mode: single
- id: automation.alarm_living_room_air_quality_is_poor
  alias: "ALARM: Living Room Air Quality is Poor"
  trigger:
    - type: motion
      platform: device
      device_id: 56a0fc235acbf9c9f708708a9682ab66
      entity_id: binary_sensor.living_room_motion
      domain: binary_sensor
    - type: motion
      platform: device
      device_id: 40a395e27caf6e3dbf69e07fa01f780d
      entity_id: binary_sensor.study_motion
      domain: binary_sensor
  condition:
    - condition: numeric_state
      entity_id: sensor.living_room_iaq_index
      below: "25"
    - type: is_not_open
      condition: device
      device_id: 0a0f7c03555607ac48933b9de5da93a6
      entity_id: binary_sensor.living_room_window
      domain: binary_sensor
    - type: is_not_open
      condition: device
      device_id: 853682a22dc992e6a13e776fd3ac105b
      entity_id: binary_sensor.study_window_n
      domain: binary_sensor
    - type: is_not_open
      condition: device
      device_id: cca7e061d97ab19596829722642432c3
      entity_id: binary_sensor.study_window_s
      domain: binary_sensor
  action:
    - service: notify.tats_devices
      data:
        message: "Living Room Air Quality is Poor. Current: {{ states('sensor.living_room_iaq_index') }}IAQI"
        title: "⚠️ ALARM"
        data:
          url: /lovelace/home
    - delay:
        hours: 1
        minutes: 0
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.alarm_living_room_co2_is_too_high
  alias: "ALARM: Living Room CO2 is Too High"
  trigger:
    - type: motion
      platform: device
      device_id: 56a0fc235acbf9c9f708708a9682ab66
      entity_id: binary_sensor.living_room_motion
      domain: binary_sensor
    - type: motion
      platform: device
      device_id: 40a395e27caf6e3dbf69e07fa01f780d
      entity_id: binary_sensor.study_motion
      domain: binary_sensor
  condition:
    - condition: numeric_state
      entity_id: sensor.living_room_co2
      above: "1000"
    - type: is_not_open
      condition: device
      device_id: 0a0f7c03555607ac48933b9de5da93a6
      entity_id: binary_sensor.living_room_window
      domain: binary_sensor
    - type: is_not_open
      condition: device
      device_id: 853682a22dc992e6a13e776fd3ac105b
      entity_id: binary_sensor.study_window_n
      domain: binary_sensor
    - type: is_not_open
      condition: device
      device_id: cca7e061d97ab19596829722642432c3
      entity_id: binary_sensor.study_window_s
      domain: binary_sensor
  action:
    - service: notify.all_devices
      data:
        title: "⚠️ ALARM"
        message: "Living Room CO2 is too high. Current: {{ states('sensor.living_room_co2') }}ppm"
        data:
          url: /lovelace/home
    - delay:
        hours: 1
        minutes: 0
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.alarm_suicas_balance_is_not_enough
  alias: "ALARM: Suica’s Balance is Not Enough"
  trigger:
    - platform: state
      entity_id: sensor.mamorail
      from: 入場
    - platform: state
      entity_id: sensor.mamorail
      from: 出場
  condition:
    - condition: numeric_state
      entity_id: sensor.mamorail_balance
      below: '1000'
  action:
    - service: notify.all_devices
      data:
        title: "⚠️ ALARM"
        message: "️Suica’s balance is not enough. Current: {{ states('sensor.mamorail_balance') }}yen"
        data:
          url: /lovelace-people/poeple
  mode: single
- id: automation.alarm_zulu_is_offline
  alias: "ALARM: zulu is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.zulu
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: zulu is offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_romeo_is_offline
  alias: "ALARM: romeo is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.romeo
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: romeo is offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_tango_is_offline
  alias: "ALARM: tango is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.tango
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: tango is offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_xray_liv_is_offline
  alias: "ALARM: xray-liv is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.xray_liv
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: xray-liv is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_xray_sto_is_offline
  alias: "ALARM: xray-sto is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.xray_sto
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: xray-sto is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_amazonplug_is_offline
  alias: "ALARM: amazonplug is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.amazonplug
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: amazonplug is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_aventage_is_offline
  alias: "ALARM: aventage is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.aventage
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: aventage is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_catloghome_bed_is_offline
  alias: "ALARM: catloghome-bed is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.catloghome_bed
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️catloghome-bed is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_catloghome_liv_is_offline
  alias: "ALARM: catloghome-liv is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.catloghome_liv
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: catloghome-liv is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_daikinhvac_is_offline
  alias: "ALARM: daikinhvac is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.daikinhvac
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: daikinhvac is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_fox_is_offline
  alias: "ALARM: fox is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.fox
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: fox is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_guppy_is_offline
  alias: "ALARM: guppy is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.guppy
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: guppy is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_hotel_is_offline
  alias: "ALARM: hotel is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.hotel
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: hotel is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_huebridge_is_offline
  alias: "ALARM: huebridge is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.huebridge
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: huebridge is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_justio_is_offline
  alias: "ALARM: justio is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.justio
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️justio is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_jq300_is_offline
  alias: "ALARM: jq300 is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.jq300
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️jq300 is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_kasaplug_ent_is_offline
  alias: "ALARM: kasaplug-ent is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.kasaplug_ent
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️kasaplug-ent is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_kasaplug_liv_is_offline
  alias: "ALARM: kasaplug-liv is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.kasaplug_liv
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️kasaplug-liv is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_regza_is_offline
  alias: "ALARM: regza is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.regza
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: regza is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_remo_bed_is_offline
  alias: "ALARM: remo-bed is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.remo_bed
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️remo-bed is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_remo_liv_is_offline
  alias: "ALARM: remo-liv is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.remo_liv
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: remo-liv is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_sesamemodule_is_offline
  alias: "ALARM: sesamemodule is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.sesamemodule
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: sesamemodule is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_switchbothub_is_offline
  alias: "ALARM: switchbothub is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.switchbothub
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️switchbothub is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_tuyaplug_is_offline
  alias: "ALARM: tuyaplug is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.tuyaplug
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️tuyaplug is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_wfirex_is_offline
  alias: "ALARM: wfirex is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.wfirex
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️wfirex is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.alarm_xiaomigateway_is_offline
  alias: "ALARM: xiaomigateway is Offline"
  trigger:
    - platform: state
      entity_id: binary_sensor.xiaomigateway
      to: "off"
      for: "00:31:00"
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️xiaomigateway is Offline
        data:
          url: /lovelace-machines/machines
  mode: single
- id: automation.info_denshobato
  alias: "INFO: Denshobato"
  trigger:
    - platform: state
      entity_id: sensor.denshobato
  condition:
    - condition: template
      value_template: >-
        {{ (as_timestamp(now()) -
        as_timestamp(states('sensor.denshobato_received_date_time'))) < 180 }}
  action:
    - service: notify.all_devices
      data:
        title: "[% notify_title_k %]"
        message: "️{{ states('sensor.denshobato_time') }}に{{ states('sensor.denshobato_action') }}しました"
  mode: single
- id: automation.info_mamorail
  alias: "INFO: Mamorail"
  trigger:
    - platform: state
      entity_id: sensor.mamorail
  condition:
    - condition: template
      value_template: >-
        {{ (as_timestamp(now()) -
        as_timestamp(states('sensor.mamorail_received_date_time'))) < 180 }}
  action:
    - service: notify.all_devices
      data:
        title: "[% notify_title_k %]"
        message: "️{{ states('sensor.mamorail_station') }}を{{ states('sensor.mamorail_time') }}に{{ states('sensor.mamorail_action') }}しました。残高: {{ states('sensor.mamorail_balance') }}円"
        data:
          url: /lovelace-people/people
  mode: single
- id: automation.info_update_available
  alias: "INFO: Update Available"
  trigger:
    - platform: state
      entity_id: binary_sensor.updater
      from: "off"
      to: "on"
  action:
    - service: notify.tats_devices
      data:
        title: INFO
        message: "Home Assistant {{ state_attr('binary_sensor.updater', 'newest_version') }} is available."
- id: automation.alarm_living_room_temperature_difference_is_too_large
  alias: "ALARM: Living Room Temperature Difference is Too Large"
  trigger:
    - platform: state
      entity_id: sensor.living_room_switchbot_meter_temperature
  condition:
    - condition: numeric_state
      entity_id: sensor.average_of_living_room_temperature_difference
      attribute: min_value
      above: '1'
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: Living Room Temperature Difference is Too Large
        data:
          url: /lovelace/home
  mode: single
- id: automation.alarm_bedroom_temperature_difference_is_too_large
  alias: "ALARM: Bedroom Temperature Difference is Too Large"
  trigger:
    - platform: state
      entity_id: sensor.bedroom_switchbot_meter_temperature
  condition:
    - condition: numeric_state
      entity_id: sensor.average_of_bedroom_temperature_difference
      attribute: min_value
      above: '1'
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️Bedroom Temperature Difference is Too Large
        data:
          url: /lovelace/home
  mode: single
- id: automation.alarm_balcony_temperature_difference_is_too_large
  alias: "ALARM: Balcony Temperature Difference is Too Large"
  trigger:
    - platform: state
      entity_id: sensor.balcony_switchbot_meter_temperature
  condition:
    - condition: numeric_state
      entity_id: sensor.average_of_balcony_temperature_difference
      attribute: min_value
      above: '1'
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: Balcony Temperature Difference is Too Large
        data:
          url: /lovelace/home
  mode: single
- id: automation.alarm_living_room_humidity_difference_is_too_large
  alias: "ALARM: Living Room Humidity Difference is Too Large"
  trigger:
    - platform: state
      entity_id: sensor.living_room_switchbot_meter_temperature
      attribute: humidity
  condition:
    - condition: numeric_state
      entity_id: sensor.average_of_living_room_humidity_difference
      attribute: min_value
      above: '10'
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: Living Room Humidity Difference is Too Large
        data:
          url: /lovelace/home
  mode: single
- id: automation.alarm_bedroom_humidity_difference_is_too_large
  alias: "ALARM: Bedroom Humidity Difference is Too Large"
  trigger:
    - platform: state
      entity_id: sensor.bedroom_switchbot_meter_temperature
      attribute: humidity
  condition:
    - condition: numeric_state
      entity_id: sensor.average_of_bedroom_humidity_difference
      attribute: min_value
      above: '10'
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️Bedroom Humidity Difference is Too Large
        data:
          url: /lovelace/home
  mode: single
- id: automation.alarm_balcony_humidity_difference_is_too_large
  alias: "ALARM: Balcony Humidity Difference is Too Large"
  trigger:
    - platform: state
      entity_id: sensor.balcony_switchbot_meter_temperature
      attribute: humidity
  condition:
    - condition: numeric_state
      entity_id: sensor.average_of_balcony_humidity_difference
      attribute: min_value
      above: '10'
  action:
    - service: notify.tats_devices
      data:
        title: "⚠️ ALARM"
        message: ️Balcony Humidity Difference is Too Large
        data:
          url: /lovelace/home
  mode: single
- id: automation.turn_on_surveillance_when_ios_action_fires
  alias: Turn on surveillance when iOS Action Fires
  trigger:
    - platform: event
      event_type: ios.action_fired
      event_data:
        actionName: turn_on_surveillance
  action:
    - service: alarm_control_panel.alarm_arm_away
      target:
        entity_id: alarm_control_panel.surveillance
    - service: notify.tats_devices
      data:
        message: Now Arming Away
        data:
          url: /lovelace/home
    - delay:
        hours: 0
        minutes: 10
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.turn_on_surveillance_when_nobody_is_in_home
  alias: Turn on surveillance when Nobody is in Home
  trigger:
    - platform: state
      entity_id: person.shibata_tats
    - platform: state
      entity_id: person.shibata_akiko
  condition:
    - condition: not
      conditions:
        - condition: state
          entity_id: person.shibata_tats
          state: home
        - condition: state
          entity_id: person.shibata_akiko
          state: home
  action:
    - service: alarm_control_panel.alarm_arm_away
      target:
        entity_id: alarm_control_panel.surveillance
    - service: notify.all_devices
      data:
        message: Turn on surveillance because nobody is in home
    - delay:
        hours: 0
        minutes: 10
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.turn_on_monitor_bio
  alias: Turn on monitor bio
  trigger:
    - platform: numeric_state
      entity_id: sensor.monitor_bio
      above: 10
  action:
    - service: device_tracker.see
      data:
        dev_id: monitor_bio
        location_name: home
        source_type: bluetooth
- id: automation.turn_off_monitor_bio
  alias: Turn off monitor bio
  trigger:
    - platform: numeric_state
      entity_id: sensor.monitor_bio
      below: 10
  action:
    - service: device_tracker.see
      data:
        dev_id: monitor_bio
        location_name: not_home
        source_type: bluetooth
- id: automation.turn_on_monitor_akikos_iphone12mini
  alias: Turn on monitor akikos-iphone12mini
  trigger:
    - platform: numeric_state
      entity_id: sensor.monitor_akikos_iphone12mini
      above: 10
  action:
    - service: device_tracker.see
      data:
        dev_id: monitor_akikos_iphone12mini
        location_name: home
        source_type: bluetooth
- id: automation.turn_off_monitor_akikos_iphone12mini
  alias: Turn off monitor akikos-iphone12mini
  trigger:
    - platform: numeric_state
      entity_id: sensor.monitor_akikos_iphone12mini
      below: 10
  action:
    - service: device_tracker.see
      data:
        dev_id: monitor_akikos_iphone12mini
        location_name: not_home
        source_type: bluetooth
- id: automation.open_bedroom_curtains_temporarily
  alias: Open Bedroom Curtains Temporarily
  description: Open the curtains in the bedroom temporarily
  trigger:
    - platform: time
      at: input_datetime.bedroom_curtains_opened_time
  action:
    - service: switch.turn_on
      entity_id: switch.bedroom_curtains
  mode: single
- id: automation.open_bedroom_curtains_workday
  alias: Open Bedroom Curtains Workday
  description: Open the curtains in the bedroom every workday
  trigger:
    - platform: time
      at: input_datetime.bedroom_curtains_opened_time_workday
  condition:
    - condition: state
      entity_id: binary_sensor.workday_sensor
      state: 'on'
  action:
    - service: switch.turn_on
      entity_id: switch.bedroom_curtains
  mode: single
- id: automation.turn_down_bedroom
  alias: Turn down Bedroom
  description: Turn down the bedroom
  trigger:
    - platform: time
      at: input_datetime.bedroom_turned_down_time
  action:
  - service: switch.turn_off
    entity_id: switch.bedroom_curtains
  mode: single
- id: automation.turn_down_living_area
  alias: Turn down Living Area
  description: Turn down the living area
  trigger:
    - platform: time
      at: input_datetime.living_area_turned_down_time
  action:
    - service: scene.turn_on
      entity_id: scene.living_area_turned_down
    - service: light.turn_on
      entity_id: light.living_area_dimming_downlights
  mode: single
- id: automation.turn_down_living_area_more
  alias: Turn down Living Area More
  description: Turn down the living area more
  trigger:
    - platform: time
      at: input_datetime.living_area_turned_down_more_time
  action:
    - service: scene.turn_on
      entity_id: scene.living_area_turned_down_more
    - service: light.turn_off
      entity_id: light.living_area_dimming_downlights
  mode: single
- id: automation.turn_off_living_room_extra_lights
  alias: Turn off Living Room Extra Lights
  description: Turn off the extra lights in the living room
  trigger:
    - platform: sun
      event: sunrise
  action:
    - service: light.turn_off
      target:
        entity_id:
        - light.living_room_tv_light
        - light.living_room_entrance_light
        - light.living_room_footlight
  mode: single
- id: automation.turn_on_living_room_hvac
  alias: Turn off Living Room HVAC
  description: Turn off the HVAC in the living room
  trigger:
    - type: motion
      platform: device
      device_id: 56a0fc235acbf9c9f708708a9682ab66
      entity_id: binary_sensor.living_room_motion
      domain: binary_sensor
    - type: motion
      platform: device
      device_id: 40a395e27caf6e3dbf69e07fa01f780d
      entity_id: binary_sensor.study_motion
      domain: binary_sensor
  condition:
    - condition: numeric_state
      entity_id: sensor.living_room_wbgt
      below: input_number.living_room_hvac_cool_turned_off_threshold
  action:
    - service: climate.set_hvac_mode
      target:
        entity_id: climate.living_room_hvac
      data:
        hvac_mode: off
    - service: notify.tats_devices
      data:
        message: "Turned on Living Room HVAC Cool. Current: {{ states('sensor.living_room_temperature') }}°C"
        data:
          url: /lovelace/home
    - delay:
        hours: 1
        minutes: 0
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.turn_off_living_room_humidifier
  alias: Turn off Living Room Humidifier
  description: Turn off the humidifier in the living room when the humidity is too high
  trigger:
    - type: motion
      platform: device
      device_id: 56a0fc235acbf9c9f708708a9682ab66
      entity_id: binary_sensor.living_room_motion
      domain: binary_sensor
    - type: motion
      platform: device
      device_id: 40a395e27caf6e3dbf69e07fa01f780d
      entity_id: binary_sensor.study_motion
      domain: binary_sensor
  condition:
    - condition: numeric_state
      entity_id: sensor.living_room_humidity
      above: input_number.living_room_humidifier_turned_off_threshold
    - condition: state
      entity_id: switch.living_room_humidifier
      state: "on"
    - condition: state
      entity_id: binary_sensor.living_room_window
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.study_window_n
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.study_window_s
      state: "off"
      for: 00:30:00
  action:
    - service: switch.turn_off
      entity_id: switch.living_room_humidifier
    - service: notify.tats_devices
      data:
        message: "Turned off Living Room Humidifier. Current: {{ states('sensor.living_room_humidity') }}%"
        data:
          url: /lovelace/home
    - delay:
        hours: 1
        minutes: 0
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.turn_off_living_room_hvac_fan
  alias: Turn off Living Room HVAC Fan
  description: Turn off the HVAC in the living room with fan mode
  trigger:
    - platform: time
      at: '5:30'
  action:
    - service: climate.turn_off
      target:
        entity_id: climate.living_room_hvac
    - service: notify.tats_devices
      data:
        message: Turned off Living Room HVAC Fan
        data:
          url: /lovelace/home
    - service: automation.turn_off
      target:
        entity_id:
          - automation.turn_on_living_room_hvac_fan
          - automation.turn_off_living_room_hvac_fan
  mode: single
- id: automation.turn_off_living_area_lights
  alias: Turn off Living Area Lights
  description: Turn off the living area lights when iOS action fires
  trigger:
    - platform: event
      event_type: ios.action_fired
      event_data:
        actionName: turn_off_living_room_lights
  action:
    - service: light.turn_off
      target:
        entity_id: light.living_area_lights
    - service: notify.tats_devices
      data:
        message: Turned off Living Room Lights
        data:
          url: /lovelace/home
    - delay:
        hours: 0
        minutes: 10
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.turn_off_living_room_lights_appliances
  alias: Turn off Living Room Lights & Appliances
  description: Turn off the living room lights & appliances when iOS action fires
  trigger:
    - platform: event
      event_type: ios.action_fired
      event_data:
        actionName: turn_off_living_room_lights_appliances
  action:
    - service: light.turn_off
      target:
        entity_id: light.living_area_lights
    - service: fan.turn_off
      target:
        entity_id: fan.living_room_ceiling_fans
    - condition: state
      entity_id: switch.living_room_humidifier
      state: 'on' 
    - service: switch.turn_off
      target:
        entity_id: switch.living_room_humidifier
  mode: single
- id: automation.turn_off_surveillance
  alias: Turn off Surveillance
  description: Turn off Surveillance when someone is at home
  trigger:
    - platform: state
      entity_id: person.shibata_tats
      to: home
    - platform: state
      entity_id: person.shibata_akiko
      to: home
  condition:
    - condition: state
      entity_id: alarm_control_panel.surveillance
      state: armed_away
  action:
    - service: alarm_control_panel.alarm_disarm
      target:
        entity_id: alarm_control_panel.surveillance
    - service: notify.all_devices
      data:
        message: Turned off surveillance
        data:
          url: /lovelace/home
    - delay:
        hours: 0
        minutes: 10
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.plan_to_turn_on_living_room_hvac_fan
  alias: Plan to Turn on Living Room HVAC Fan 
  description: Plan to turn on the HVAC in the living room with fan mode
  trigger:
    - platform: state
      entity_id: climate.living_room_hvac
      to: dry
      for: '01:00:00'
    - platform: state
      entity_id: climate.living_room_hvac
      to: cool
      for: '01:00:00'
    - platform: state
      entity_id: climate.living_room_hvac
      to: heat_cool
      for: '01:00:00'
  action:
    - service: automation.turn_on
      target:
        entity_id:
          - automation.turn_on_living_room_hvac_fan
          - automation.turn_off_living_room_hvac_fan
  mode: single
- id: automation.turn_on_living_area_floor_heating
  alias: Turn on Living Area Floor Heating
  description: Turn on the floor heating in the living area when the temperature is too low
  trigger:
    - type: motion
      platform: device
      device_id: 56a0fc235acbf9c9f708708a9682ab66
      entity_id: binary_sensor.living_room_motion
      domain: binary_sensor
    - type: motion
      platform: device
      device_id: 40a395e27caf6e3dbf69e07fa01f780d
      entity_id: binary_sensor.study_motion
      domain: binary_sensor
  condition:
    - condition: numeric_state
      entity_id: sensor.living_room_temperature
      below: input_number.living_room_floor_heating_turned_on_threshold
    - condition: sun
      after: sunrise
    - condition: state
      entity_id: sensor.season
      state: winter
    - condition: state
      entity_id: binary_sensor.living_room_window
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.study_window_n
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.study_window_s
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.bedroom_window_n
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.bedroom_window_s
      state: "off"
      for: 00:30:00
  action:
    - service: switch.toggle
      entity_id: switch.living_room_floor_heating
    - service: switch.toggle
      entity_id: switch.study_floor_heating
    - service: notify.tats_devices
      data:
        message: "Turned on Living Area Floor Heating. Current: {{ states('sensor.living_room_temperature') }}°C"
        data:
          url: /lovelace/home
    - delay:
        hours: 1
        minutes: 0
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.turn_on_bedroom_hvac_cleaner
  alias: Turn on Bedroom HVAC Cleaner
  description: Turn on the HVAC cleaner in the bedroom
  trigger:
    - platform: time
      at: '16:00'
  condition:
    - condition: time
      weekday:
        - sun
  action:
    - service: switch.turn_on
      target:
        entity_id: switch.bedroom_hvac_cleaner
    - service: notify.tats_devices
      data:
        message: Turned on Bedroom HVAC Cleaner
        data:
          url: /lovelace/home
  mode: single
- id: automation.turn_on_living_room_hvac_cleaner
  alias: Turn on Living Room HVAC Cleaner
  description: Turn on the HVAC cleaner in the living room
  trigger:
    - platform: time
      at: 04:00:00
  condition:
    - condition: time
      weekday:
      - tue
  action:
    - service: switch.turn_on
      entity_id: switch.living_room_hvac_cleaner
    - service: notify.tats_devices
      data:
        message: Turned on Living Room HVAC Cleaner
        data:
          url: /lovelace/home
  mode: single
- id: automation.turn_on_living_room_hvac_cool
  alias: Turn on Living Room HVAC Cool
  description: Turn on the HVAC in the living room with cool mode
  trigger:
    - type: motion
      platform: device
      device_id: 56a0fc235acbf9c9f708708a9682ab66
      entity_id: binary_sensor.living_room_motion
      domain: binary_sensor
    - type: motion
      platform: device
      device_id: 40a395e27caf6e3dbf69e07fa01f780d
      entity_id: binary_sensor.study_motion
      domain: binary_sensor
  condition:
    - condition: numeric_state
      entity_id: sensor.living_room_wbgt
      above: input_number.living_room_hvac_cool_turned_on_threshold
    - condition: state
      entity_id: binary_sensor.living_room_window
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.study_window_n
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.study_window_s
      state: "off"
      for: 00:30:00
  action:
    - service: climate.set_hvac_mode
      target:
        entity_id: climate.living_room_hvac
      data:
        hvac_mode: cool
    - service: notify.tats_devices
      data:
        message: "Turned on Living Room HVAC Cool. Current: {{ states('sensor.living_room_temperature') }}°C"
        data:
          url: /lovelace/home
    - delay:
        hours: 1
        minutes: 0
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.turn_on_living_room_hvac_cool_forcibly
  alias: Turn on Living Room HVAC Cool Forcibly
  description: Turn on the HVAC in the living room with cool mode forcibly
  trigger:
    - platform: time_pattern
      minutes: '5'
  condition:
    - condition: numeric_state
      entity_id: sensor.living_room_wbgt
      above: input_number.living_room_hvac_cool_forcibly_turned_on_threshold
    - condition: state
      entity_id: binary_sensor.living_room_window
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.study_window_n
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.study_window_s
      state: "off"
      for: 00:30:00
  action:
    - service: climate.set_hvac_mode
      target:
        entity_id: climate.living_room_hvac
      data:
        hvac_mode: cool
    - service: notify.tats_devices
      data:
        message: "Turned on Living Room HVAC Cool Forcibly. Current: {{ states('sensor.living_room_temperature') }}°C"
        data:
          url: /lovelace/home
    - delay:
        hours: 1
        minutes: 0
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.turn_on_living_room_hvac_dry
  alias: Turn on Living Room HVAC Dry
  description: Turn on the HVAC in the living room with dry mode
  trigger:
    - type: motion
      platform: device
      device_id: 56a0fc235acbf9c9f708708a9682ab66
      entity_id: binary_sensor.living_room_motion
      domain: binary_sensor
    - type: motion
      platform: device
      device_id: 40a395e27caf6e3dbf69e07fa01f780d
      entity_id: binary_sensor.study_motion
      domain: binary_sensor
  condition:
    - condition: numeric_state
      entity_id: sensor.living_room_humidity
      above: input_number.living_room_hvac_dry_turned_on_threshold
    - condition: numeric_state
      entity_id: sensor.living_room_wbgt
      below: input_number.living_room_hvac_cool_turned_on_threshold
    - condition: state
      entity_id: climate.living_room_hvac
      state: 'off'
    - condition: state
      entity_id: binary_sensor.living_room_window
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.study_window_n
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.study_window_s
      state: "off"
      for: 00:30:00
  action:
    - service: climate.set_hvac_mode
      target:
        entity_id: climate.living_room_hvac
      data:
        hvac_mode: dry
    - service: notify.tats_devices
      data:
        message: "Turned on Living Room HVAC Dry. Current: {{ states('sensor.living_room_humidifier') }}%"
        data:
          url: /lovelace/home
    - delay:
        hours: 1
        minutes: 0
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.turn_on_living_room_hvac_fan
  alias: Turn on Living Room HVAC Fan
  description: Turn on the HVAC in the living room with fan mode
  trigger:
    - platform: time
      at: '4:30'
  action:
    - service: climate.set_hvac_mode
      target:
        entity_id: climate.living_room_hvac
      data:
        hvac_mode: fan_only
    - service: notify.tats_devices
      data:
        message: Turned on Living Room HVAC Fan
        data:
          url: /lovelace/home
  mode: single
- id: automation.turn_on_living_room_ceiling_fan
  alias: Turn on Living Room Ceiling Fan
  description: Turn on the ceiling fan in the living room
  trigger:
    - platform: sun
      event: sunrise
  action:
    - service: fan.turn_on
      entity_id: fan.living_room_ceiling_fans
  mode: single
- id: automation.turn_on_living_area_downlights
  alias: Turn on Living Area Downlights
  description: Turn on the downlights in living area when the light level is too low
  trigger:
    - type: motion
      platform: device
      device_id: 56a0fc235acbf9c9f708708a9682ab66
      entity_id: binary_sensor.living_room_motion
      domain: binary_sensor
    - type: motion
      platform: device
      device_id: 40a395e27caf6e3dbf69e07fa01f780d
      entity_id: binary_sensor.study_motion
      domain: binary_sensor
  condition:
    - condition: numeric_state
      entity_id: sensor.living_room_light_level
      below: input_number.living_area_downlights_turned_on_threshold
    - condition: state
      entity_id: sun.sun
      state: above_horizon
  action:
    - service: light.turn_on
      entity_id: light.living_area_downlights
    - service: notify.tats_devices
      data:
        message: "Turned on Living Room Downlights. Current: {{ states('sensor.living_room_light_level') }}lx"
        data:
          url: /lovelace/home
    - delay:
        hours: 1
        minutes: 0
        seconds: 0
        milliseconds: 0
  mode: single
- id: automation.turn_on_living_room_humidifier
  alias: Turn on Living Room Humidifier
  description: Turn on the humidifier on the living room when the humidity is too low
  trigger:
    - type: motion
      platform: device
      device_id: 56a0fc235acbf9c9f708708a9682ab66
      entity_id: binary_sensor.living_room_motion
      domain: binary_sensor
    - type: motion
      platform: device
      device_id: 40a395e27caf6e3dbf69e07fa01f780d
      entity_id: binary_sensor.study_motion
      domain: binary_sensor
  condition:
    - condition: numeric_state
      entity_id: sensor.living_room_humidity
      below: input_number.living_room_humidifier_turned_on_threshold
    - condition: state
      entity_id: switch.living_room_humidifier
      state: "off"
    - condition: sun
      after: sunrise
    - condition: state
      entity_id: binary_sensor.living_room_window
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.study_window_n
      state: "off"
      for: 00:30:00
    - condition: state
      entity_id: binary_sensor.study_window_s
      state: "off"
      for: 00:30:00
  action:
    - service: switch.turn_on
      entity_id: switch.living_room_humidifier
    - service: notify.tats_devices
      data:
        message: "Turned on Living Room Humidifier. Current: {{ states('sensor.living_room_humidity') }}%"
        data:
          url: /lovelace/home
    - delay:
        hours: 1
        minutes: 0
        seconds: 0
        milliseconds: 0
  mode: single
