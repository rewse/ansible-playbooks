- id: automation.adjust_living_room_ac_temp
  alias: "Adjust Living Room AC Temperature"
  triggers:
    - trigger: state
      entity_id: input_number.living_room_temp_target
    - trigger: time_pattern
      minutes: "/5"
      seconds: 24
    - trigger: homeassistant
      event: start
  conditions:
    - condition: state
      entity_id: climate.living_room_ac
      state:
        - "cool"
        - "heat"
      for:
        minutes: 9
  actions:
    - choose:
        - conditions:
            - >-
              {{
                float(states('sensor.living_room_temperature')) -
                float(states('input_number.living_room_temp_target')) < -0.5
              }}
          sequence:
            - action: climate.set_temperature
              target:
                entity_id: climate.living_room_ac
              data:
                temperature: "{{ int(states('sensor.living_room_ac_temp')) + 1 }}"
            - delay:
                minutes: 9
        - conditions:
            - >-
              {{
                float(states('sensor.living_room_temperature')) -
                float(states('input_number.living_room_temp_target')) > 0.5
              }}
          sequence:
            - action: climate.set_temperature
              target:
                entity_id: climate.living_room_ac
              data:
                temperature: "{{ int(states('sensor.living_room_ac_temp')) - 1 }}"
            - delay:
                minutes: 9
  trace:
    stored_traces: 100
- id: automation.change_living_room_ac_from_heatcool
  alias: "Change Living Room AC from HeatCool"
  triggers:
    - trigger: state
      entity_id: climate.living_room_ac
      to: "heat_cool"
  actions:
    - choose:
        - conditions:
            - condition: state
              entity_id: input_select.season_mode
              state: "Summer"
            - >-
              {{
                float(states('sensor.living_room_humidity')) >
                float(states('input_number.living_room_humidity_target_present_summer')) +
                float(states('input_number.living_room_humidity_max_diff_present_summer'))
              }}
            - >-
              {{
                float(states('sensor.living_room_temperature')) <
                float(states('input_number.living_room_temp_target_present_summer')) -
                float(states('input_number.living_room_temp_min_diff_present_summer'))
              }}
          sequence:
            - action: climate.set_hvac_mode
              target:
                entity_id: climate.living_room_ac
              data:
                hvac_mode: dry
        - conditions:
            - condition: state
              entity_id: input_select.season_mode
              state: "Summer"
          sequence:
            - action: climate.set_hvac_mode
              target:
                entity_id: climate.living_room_ac
              data:
                hvac_mode: cool
            - action: climate.set_temperature
              target:
                entity_id: climate.living_room_ac
              data:
                temperature: "{{ int(states('input_number.living_room_temp_target_present_summer')) }}"
        - conditions:
            - condition: state
              entity_id: input_select.season_mode
              state: "Winter"
          sequence:
            - action: climate.set_hvac_mode
              target:
                entity_id: climate.living_room_ac
              data:
                hvac_mode: heat
            - action: climate.set_temperature
              target:
                entity_id: climate.living_room_ac
              data:
                temperature: "{{ int(states('input_number.living_room_temp_target_present_winter')) }}"
  trace:
    stored_traces: 100
- id: automation.notify_living_room_climate
  alias: "Notify Living Room Climate"
  triggers:
    - trigger: event
      event_type: "living_room_humidity_too_high"
      id: "living_room_humidity_too_high"
    - trigger: event
      event_type: "living_room_humidity_too_low"
      id: "living_room_humidity_too_low"
    - trigger: event
      event_type: "living_room_temp_too_high"
      id: "living_room_temp_too_high"
    - trigger: event
      event_type: "living_room_temp_too_low"
      id: "living_room_temp_too_low"
  actions:
    - choose:
        - conditions:
            - condition: trigger
              id: "living_room_humidity_too_high"
          sequence:
            - action: notify.all_devices
              data:
                message: >-
                  Living Room Humidity is Too High.
                  Current: {{ states('sensor.living_room_humidity') }}%
                data:
                  push:
                    interruption-level: time-sensitive
                  url: "/lovelace/overview"
            - delay:
                hours: 2
        - conditions:
            - condition: trigger
              id: "living_room_humidity_too_low"
          sequence:
            - action: notify.all_devices
              data:
                message: >-
                  Living Room Humidity is Too Low.
                  Current: {{ states('sensor.living_room_humidity') }}%
                data:
                  push:
                    interruption-level: time-sensitive
                  url: "/lovelace/overview"
            - delay:
                hours: 2
        - conditions:
            - condition: trigger
              id: "living_room_temp_too_high"
          sequence:
            - action: notify.all_devices
              data:
                message: >-
                  Living Room Temperature is Too High.
                  Current: {{ states('sensor.living_room_temperature') }}°C
                data:
                  push:
                    interruption-level: time-sensitive
                  url: "/lovelace/overview"
            - delay:
                hours: 2
        - conditions:
            - condition: trigger
              id: "living_room_temp_too_low"
          sequence:
            - action: notify.all_devices
              data:
                message: >-
                  Living Room Temperature is Too low.
                  Current: {{ states('sensor.living_room_temperature') }}°C
                data:
                  push:
                    interruption-level: time-sensitive
                  url: "/lovelace/overview"
            - delay:
                hours: 2
  trace:
    stored_traces: 100
- id: automation.change_living_room_ac_mode
  alias: "Change Living Room AC Mode"
  triggers:
    - trigger: time_pattern
      minutes: "/5"
      seconds: 30
    - trigger: homeassistant
      event: start
  conditions:
    - condition: state
      entity_id: climate.living_room_ac
      state:
        - "cool"
        - "dry"
      for:
        minutes: 10
  actions:
    - choose:
        - conditions:
            - condition: state
              entity_id: climate.living_room_ac
              state: "dry"
            - or:
                - and:
                    - >-
                        {{
                          float(states('sensor.living_room_temperature')) <
                          float(states('input_number.living_room_temp_target'))
                        }}
                    - >-
                        {{
                          float(states('sensor.living_room_humidity')) <
                          float(states('input_number.living_room_humidity_target'))
                        }}
                - and:
                    - >-
                        {{
                          float(states('sensor.living_room_temperature')) <
                          float(states('input_number.living_room_temp_target'))
                        }}
                    - >-
                        {{
                          float(states('sensor.living_room_humidity')) >
                          float(states('input_number.living_room_humidity_target'))
                        }}
                    - >-
                        {{
                          (
                            float(states('input_number.living_room_temp_target')) -
                            float(states('sensor.living_room_temperature'))
                          ) / float(states('input_number.living_room_temp_min_diff')) >
                          (
                            float(states('sensor.living_room_humidity')) -
                            float(states('input_number.living_room_humidity_target'))
                          ) / float(states('input_number.living_room_humidity_max_diff'))
                        }}
          sequence:
            - action: climate.set_hvac_mode
              target:
                entity_id: climate.living_room_ac
              data:
                hvac_mode: "cool"
            - delay:
                seconds: 5
            - action: climate.set_temperature
              target:
                entity_id: climate.living_room_ac
              data:
                temperature: "{{ int(states('sensor.living_room_ac_temp')) + 1 }}"
            - delay:
                minutes: 29
        - conditions:
            - >-
              {{
                float(states('sensor.living_room_temperature')) >
                float(states('input_number.living_room_temp_target'))
              }}
            - >-
              {{
                (
                  float(states('sensor.living_room_temperature')) -
                  float(states('input_number.living_room_temp_target'))
                ) / float(states('input_number.living_room_temp_max_diff')) >
                (
                  float(states('sensor.living_room_humidity')) -
                  float(states('input_number.living_room_humidity_target'))
                ) / float(states('input_number.living_room_humidity_max_diff'))
              }}
          sequence:
            - action: climate.set_hvac_mode
              target:
                entity_id: climate.living_room_ac
              data:
                hvac_mode: "cool"
            - delay:
                minutes: 29
        - conditions:
            - >-
              {{
                float(states('sensor.living_room_humidity')) >
                float(states('input_number.living_room_humidity_target'))
              }}
            - >-
              {{
                (
                  float(states('sensor.living_room_temperature')) -
                  float(states('input_number.living_room_temp_target'))
                ) / float(states('input_number.living_room_temp_max_diff')) <
                (
                  float(states('sensor.living_room_humidity')) -
                  float(states('input_number.living_room_humidity_target'))
                ) / float(states('input_number.living_room_humidity_max_diff'))
              }}
          sequence:
            - action: climate.set_hvac_mode
              target:
                entity_id: climate.living_room_ac
              data:
                hvac_mode: "dry"
            - delay:
                minutes: 29
  trace:
    stored_traces: 100
- id: automation.plan_to_turn_on_living_room_ac_internal_clean
  alias: "Plan to Turn on Living Room AC Internal Clean"
  triggers:
    - trigger: state
      entity_id: climate.living_room_ac
      to:
        - "cool"
        - "dry"
      for:
        minutes: 5
  actions:
    - action: automation.turn_on
      target:
        entity_id:
          - automation.turn_on_living_room_ac_internal_clean
  trace:
    stored_traces: 100
- id: automation.recover_from_living_room_ac_manual_internal_clean
  alias: "Recover from Living Room AC Manual Internal Clean"
  triggers:
    - trigger: time
      at: input_datetime.living_room_ac_manual_internal_clean
  actions:
    - action: automation.turn_on
      target:
        entity_id:
          - automation.adjust_living_room_ac_temperature
          - automation.change_living_room_ac_mode
          - automation.toggle_living_room_ac_cooldry
          - automation.toggle_living_room_ac_heat
  trace:
    stored_traces: 100
- id: automation.select_living_room_climate_mode
  alias: "Select Living Room Climate Mode"
  triggers:
    - trigger: state
      entity_id:
        - input_select.season_mode
        - input_select.time_mode
    - trigger: state
      entity_id: input_boolean.living_room_presence_mode
      for:
        minutes: "{{ states('input_number.living_room_presence_sensitivity_minutes') }}"
    - trigger: state
      entity_id: input_boolean.living_room_presence_mode
      to: "off"
      for:
        minutes: "{{ states('input_number.living_room_climate_auto_off_minutes') }}"
    - trigger: state
      entity_id: input_boolean.living_room_window_mode
      to: "on"
      for:
        minutes: "{{ states('input_number.living_room_climate_auto_off_minutes_ventilated') }}"
    - trigger: state
      entity_id: input_boolean.living_room_window_mode
      to: "off"
    - trigger: homeassistant
      event: start
  actions:
    - choose:
        - conditions:
            - condition: state
              entity_id: input_boolean.living_room_window_mode
              state: "on"
              for:
                minutes: "{{ states('input_number.living_room_climate_auto_off_minutes_ventilated') }}"
          sequence:
            - action: input_select.select_option
              target:
                entity_id: input_select.living_room_climate_mode
              data:
                option: "Ventilated"
        - conditions:
            - condition: state
              entity_id: input_boolean.living_room_presence_mode
              state: "on"
              for:
                minutes: "{{ states('input_number.living_room_presence_sensitivity_minutes') }}"
            - condition: state
              entity_id: input_select.season_mode
              state: "Summer"
            - not:
                - condition: state
                  entity_id: input_select.time_mode
                  state:
                    - "Midnight"
                    - "Dark"
          sequence:
            - action: input_select.select_option
              target:
                entity_id: input_select.living_room_climate_mode
              data:
                option: "Present Summer"
        - conditions:
            - condition: state
              entity_id: input_boolean.living_room_presence_mode
              state: "on"
              for:
                minutes: "{{ states('input_number.living_room_presence_sensitivity_minutes') }}"
            - condition: state
              entity_id: input_select.season_mode
              state: "Winter"
            - not:
                - condition: state
                  entity_id: input_select.time_mode
                  state:
                    - "Midnight"
                    - "Dark"
          sequence:
            - action: input_select.select_option
              target:
                entity_id: input_select.living_room_climate_mode
              data:
                option: "Present Winter"
        - conditions:
            - condition: state
              entity_id: input_boolean.living_room_presence_mode
              state: "on"
              for:
                minutes: "{{ states('input_number.living_room_presence_sensitivity_minutes') }}"
            - condition: state
              entity_id: input_select.season_mode
              state: "Summer"
            - condition: state
              entity_id: input_select.time_mode
              state:
                - "Midnight"
                - "Dark"
          sequence:
            - action: input_select.select_option
              target:
                entity_id: input_select.living_room_climate_mode
              data:
                option: "Present Summer Midnight"
        - conditions:
            - condition: state
              entity_id: input_boolean.living_room_presence_mode
              state: "on"
              for:
                minutes: "{{ states('input_number.living_room_presence_sensitivity_minutes') }}"
            - condition: state
              entity_id: input_select.season_mode
              state: "Winter"
            - condition: state
              entity_id: input_select.time_mode
              state:
                - "Midnight"
                - "Dark"
          sequence:
            - action: input_select.select_option
              target:
                entity_id: input_select.living_room_climate_mode
              data:
                option: "Present Winter Midnight"
        - conditions:
            - or:
                - and:
                    - condition: state
                      entity_id: climate.living_room_ac
                      state:
                        - "fan_only"
                        - "off"
                    - condition: state
                      entity_id: input_boolean.living_room_presence_mode
                      state: "off"
                      for:
                        minutes: "{{ states('input_number.living_room_presence_sensitivity_minutes') }}"
                    - condition: state
                      entity_id: input_select.season_mode
                      state: "Summer"
                - and:
                    - condition: state
                      entity_id: climate.living_room_ac
                      state:
                        - "cool"
                        - "dry"
                        - "heat"
                    - condition: state
                      entity_id: input_boolean.living_room_presence_mode
                      state: "off"
                      for:
                        minutes: "{{ states('input_number.living_room_climate_auto_off_minutes') }}"
                    - condition: state
                      entity_id: input_select.season_mode
                      state: "Summer"
          sequence:
            - action: input_select.select_option
              target:
                entity_id: input_select.living_room_climate_mode
              data:
                option: "Absent Summer"
        - conditions:
            - or:
                - and:
                    - condition: state
                      entity_id: climate.living_room_ac
                      state: "off"
                    - condition: state
                      entity_id: input_boolean.living_room_presence_mode
                      state: "off"
                      for:
                        minutes: "{{ states('input_number.living_room_presence_sensitivity_minutes') }}"
                    - condition: state
                      entity_id: input_select.season_mode
                      state: "Winter"
                - and:
                    - condition: state
                      entity_id: climate.living_room_ac
                      state:
                        - "cool"
                        - "dry"
                        - "heat"
                    - condition: state
                      entity_id: input_boolean.living_room_presence_mode
                      state: "off"
                      for:
                        minutes: "{{ states('input_number.living_room_climate_auto_off_minutes') }}"
                    - condition: state
                      entity_id: input_select.season_mode
                      state: "Winter"
          sequence:
            - action: input_select.select_option
              target:
                entity_id: input_select.living_room_climate_mode
              data:
                option: "Absent Winter"
  trace:
    stored_traces: 100
- id: automation.select_living_room_humiture_target
  alias: "Select Living Room Humiture Target"
  triggers:
    - trigger: state
      entity_id:
        - input_select.living_room_climate_mode
        - input_number.living_room_temp_target_present_summer
        - input_number.living_room_temp_target_present_winter
        - input_number.living_room_temp_target_present_summer_midnight
        - input_number.living_room_temp_target_present_winter_midnight
        - input_number.living_room_temp_target_absent_winter
        - input_number.living_room_humidity_target_present_summer
        - input_number.living_room_humidity_target_present_winter
        - input_number.living_room_humidity_target_present_summer_midnight
        - input_number.living_room_humidity_target_present_winter_midnight
        - input_number.living_room_humidity_target_absent_winter
        - input_number.living_room_temp_max_diff_present_summer
        - input_number.living_room_temp_max_diff_present_winter
        - input_number.living_room_temp_max_diff_present_summer_midnight
        - input_number.living_room_temp_max_diff_present_winter_midnight
        - input_number.living_room_temp_max_diff_absent_winter
        - input_number.living_room_humidity_max_diff_present_summer
        - input_number.living_room_humidity_max_diff_present_winter
        - input_number.living_room_humidity_max_diff_present_summer_midnight
        - input_number.living_room_humidity_max_diff_present_winter_midnight
        - input_number.living_room_humidity_max_diff_absent_winter
        - input_number.living_room_temp_min_diff_present_summer
        - input_number.living_room_temp_min_diff_present_winter
        - input_number.living_room_temp_min_diff_present_summer_midnight
        - input_number.living_room_temp_min_diff_present_winter_midnight
        - input_number.living_room_temp_min_diff_absent_winter
        - input_number.living_room_humidity_min_diff_present_summer
        - input_number.living_room_humidity_min_diff_present_winter
        - input_number.living_room_humidity_min_diff_present_summer_midnight
        - input_number.living_room_humidity_min_diff_present_winter_midnight
        - input_number.living_room_humidity_min_diff_absent_winter
    - trigger: state
      entity_id:
        - input_number.living_room_temp_max_diff
        - input_number.living_room_humidity_max_diff
        - input_number.living_room_temp_min_diff
        - input_number.living_room_humidity_min_diff
        - input_number.living_room_temp_target
        - input_number.living_room_humidity_target
      for:
        hours: 2
    - trigger: homeassistant
      event: start
  actions:
    - choose:
        - conditions:
            - condition: state
              entity_id: input_select.living_room_climate_mode
              state: "Present Summer"
          sequence:
            repeat:
              for_each:
                - src: input_number.living_room_temp_max_diff_present_summer
                  dest: input_number.living_room_temp_max_diff
                - src: input_number.living_room_humidity_max_diff_present_summer
                  dest: input_number.living_room_humidity_max_diff
                - src: input_number.living_room_temp_min_diff_present_summer
                  dest: input_number.living_room_temp_min_diff
                - src: input_number.living_room_humidity_min_diff_present_summer
                  dest: input_number.living_room_humidity_min_diff
                - src: input_number.living_room_temp_target_present_summer
                  dest: input_number.living_room_temp_target
                - src: input_number.living_room_humidity_target_present_summer
                  dest: input_number.living_room_humidity_target
              sequence:
                - action: input_number.set_value
                  target:
                    entity_id: "{{ repeat.item.dest }}"
                  data:
                    value: "{{ states(repeat.item.src) }}"
        - conditions:
            - condition: state
              entity_id: input_select.living_room_climate_mode
              state: "Present Winter"
          sequence:
            repeat:
              for_each:
                - src: input_number.living_room_temp_max_diff_present_winter
                  dest: input_number.living_room_temp_max_diff
                - src: input_number.living_room_humidity_max_diff_present_winter
                  dest: input_number.living_room_humidity_max_diff
                - src: input_number.living_room_temp_min_diff_present_winter
                  dest: input_number.living_room_temp_min_diff
                - src: input_number.living_room_humidity_min_diff_present_winter
                  dest: input_number.living_room_humidity_min_diff
                - src: input_number.living_room_temp_target_present_winter
                  dest: input_number.living_room_temp_target
                - src: input_number.living_room_humidity_target_present_winter
                  dest: input_number.living_room_humidity_target
              sequence:
                - action: input_number.set_value
                  target:
                    entity_id: "{{ repeat.item.dest }}"
                  data:
                    value: "{{ states(repeat.item.src) }}"
        - conditions:
            - condition: state
              entity_id: input_select.living_room_climate_mode
              state: "Present Summer Midnight"
          sequence:
            repeat:
              for_each:
                - src: input_number.living_room_temp_max_diff_present_summer_midnight
                  dest: input_number.living_room_temp_max_diff
                - src: input_number.living_room_humidity_max_diff_present_summer_midnight
                  dest: input_number.living_room_humidity_max_diff
                - src: input_number.living_room_temp_min_diff_present_summer_midnight
                  dest: input_number.living_room_temp_min_diff
                - src: input_number.living_room_humidity_min_diff_present_summer_midnight
                  dest: input_number.living_room_humidity_min_diff
                - src: input_number.living_room_temp_target_present_summer_midnight
                  dest: input_number.living_room_temp_target
                - src: input_number.living_room_humidity_target_present_summer_midnight
                  dest: input_number.living_room_humidity_target
              sequence:
                - action: input_number.set_value
                  target:
                    entity_id: "{{ repeat.item.dest }}"
                  data:
                    value: "{{ states(repeat.item.src) }}"
        - conditions:
            - condition: state
              entity_id: input_select.living_room_climate_mode
              state: "Present Winter Midnight"
          sequence:
            repeat:
              for_each:
                - src: input_number.living_room_temp_max_diff_present_winter_midnight
                  dest: input_number.living_room_temp_max_diff
                - src: input_number.living_room_humidity_max_diff_present_winter_midnight
                  dest: input_number.living_room_humidity_max_diff
                - src: input_number.living_room_temp_min_diff_present_winter_midnight
                  dest: input_number.living_room_temp_min_diff
                - src: input_number.living_room_humidity_min_diff_present_winter_midnight
                  dest: input_number.living_room_humidity_min_diff
                - src: input_number.living_room_temp_target_present_winter_midnight
                  dest: input_number.living_room_temp_target
                - src: input_number.living_room_humidity_target_present_winter_midnight
                  dest: input_number.living_room_humidity_target
              sequence:
                - action: input_number.set_value
                  target:
                    entity_id: "{{ repeat.item.dest }}"
                  data:
                    value: "{{ states(repeat.item.src) }}"
        - conditions:
            - condition: state
              entity_id: input_select.living_room_climate_mode
              state: "Absent Summer"
          sequence:
            repeat:
              for_each:
                - src: input_number.living_room_temp_max_diff_absent_summer
                  dest: input_number.living_room_temp_max_diff
                - src: input_number.living_room_humidity_max_diff_absent_summer
                  dest: input_number.living_room_humidity_max_diff
                - src: input_number.living_room_temp_min_diff_absent_summer
                  dest: input_number.living_room_temp_min_diff
                - src: input_number.living_room_humidity_min_diff_absent_summer
                  dest: input_number.living_room_humidity_min_diff
                - src: input_number.living_room_temp_target_absent_summer
                  dest: input_number.living_room_temp_target
                - src: input_number.living_room_humidity_target_absent_summer
                  dest: input_number.living_room_humidity_target
              sequence:
                - action: input_number.set_value
                  target:
                    entity_id: "{{ repeat.item.dest }}"
                  data:
                    value: "{{ states(repeat.item.src) }}"
        - conditions:
            - condition: state
              entity_id: input_select.living_room_climate_mode
              state: "Absent Winter"
          sequence:
            repeat:
              for_each:
                - src: input_number.living_room_temp_max_diff_absent_winter
                  dest: input_number.living_room_temp_max_diff
                - src: input_number.living_room_humidity_max_diff_absent_winter
                  dest: input_number.living_room_humidity_max_diff
                - src: input_number.living_room_temp_min_diff_absent_winter
                  dest: input_number.living_room_temp_min_diff
                - src: input_number.living_room_humidity_min_diff_absent_winter
                  dest: input_number.living_room_humidity_min_diff
                - src: input_number.living_room_temp_target_absent_winter
                  dest: input_number.living_room_temp_target
                - src: input_number.living_room_humidity_target_absent_winter
                  dest: input_number.living_room_humidity_target
              sequence:
                - action: input_number.set_value
                  target:
                    entity_id: "{{ repeat.item.dest }}"
                  data:
                    value: "{{ states(repeat.item.src) }}"
  trace:
    stored_traces: 100
- id: automation.toggle_living_room_ac_cooldry
  alias: "Toggle Living Room AC CoolDry"
  triggers:
    - trigger: state
      entity_id:
        - input_number.living_room_temp_target
        - input_number.living_room_temp_max_diff
        - input_number.living_room_temp_min_diff
    - trigger: state
      entity_id: input_boolean.living_room_window_mode
      to: "off"
    - trigger: time_pattern
      minutes: "/5"
      seconds: 21
    - trigger: homeassistant
      event: start
  conditions:
    - condition: state
      entity_id: input_select.season_mode
      state: "Summer"
      for:
        minutes: 20
  actions:
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.living_room_temp_high
              state: "on"
            - not:
                - condition: state
                  entity_id: climate.living_room_ac
                  state: "cool"
            - not:
                - condition: state
                  entity_id: input_select.time_mode
                  state: "Midnight"
          sequence:
            - choose:
                - conditions:
                    - or:
                        - condition: state
                          entity_id: input_boolean.living_room_window_mode
                          state: "on"
                          for:
                            minutes: 10
                        - condition: state
                          entity_id: input_select.time_mode
                          state: "Late Night"
                  sequence:
                    - event: "living_room_temp_too_high"
                - conditions:
                    - condition: state
                      entity_id: input_boolean.living_room_window_mode
                      state: "off"
                      for:
                        minutes: 10
                  sequence:
                    - action: climate.set_temperature
                      target:
                        entity_id: climate.living_room_ac
                      data:
                        hvac_mode: "cool"
                        temperature: "{{ int(states('input_number.living_room_temp_target')) }}"
                    - action: notify.all_devices
                      data:
                        message: >-
                          Turned on Living Room AC Cool.
                          Current: {{ states('sensor.living_room_temperature') }}°C
                        data:
                          push:
                            interruption-level: time-sensitive
                          url: "/lovelace/overview"
                    - delay:
                        hours: 2
        - conditions:
            - condition: state
              entity_id: binary_sensor.living_room_humidity_high
              state: "on"
            - condition: state
              entity_id: binary_sensor.living_room_temp_high
              state: "off"
            - not:
                - condition: state
                  entity_id: climate.living_room_ac
                  state:
                    - "fan_only"
                    - "dry"
            - not:
                - condition: state
                  entity_id: input_select.time_mode
                  state: "Midnight"
          sequence:
            - choose:
                - conditions:
                    - or:
                        - condition: state
                          entity_id: input_boolean.living_room_window_mode
                          state: "on"
                          for:
                            minutes: 10
                        - condition: state
                          entity_id: input_select.time_mode
                          state: "Late Night"
                  sequence:
                    - event: "living_room_humidity_too_high"
                - conditions:
                    - condition: state
                      entity_id: input_boolean.living_room_window_mode
                      state: "off"
                      for:
                        minutes: 10
                  sequence:
                    - action: climate.set_hvac_mode
                      target:
                        entity_id: climate.living_room_ac
                      data:
                        hvac_mode: "dry"
                    - action: notify.all_devices
                      data:
                        message: >-
                          Turned on Living Room AC Dry.
                          Current: {{ states('sensor.living_room_humidity') }}%
                        data:
                          push:
                            interruption-level: time-sensitive
                          url: "/lovelace/overview"
                    - delay:
                        hours: 2
        - conditions:
            - condition: state
              entity_id: binary_sensor.living_room_temp_low
              state: "on"
              for:
                hours: 1
            - condition: state
              entity_id: binary_sensor.living_room_humidity_low
              state: "on"
              for:
                hours: 1
            - condition: state
              entity_id: binary_sensor.living_room_ac_cooldry
              state: "on"
              for:
                hours: 1
            - not:
                - condition: state
                  entity_id: alarm_control_panel.home
                  state: armed_vacation
          sequence:
            - action: climate.turn_off
              target:
                entity_id: climate.living_room_ac
            - action: notify.all_devices
              data:
                message: >-
                  Turned off Living Room AC.
                  Current: {{ states('sensor.living_room_temperature') }}°C, 
                  {{ states('sensor.living_room_humidity') }}%
                data:
                  push:
                    interruption-level: time-sensitive
                  url: "/lovelace/overview"
            - delay:
                hours: 2
  trace:
    stored_traces: 100
- id: automation.toggle_living_room_ac_heat
  alias: "Toggle Living Room AC Heat"
  triggers:
    - trigger: state
      entity_id:
        - input_number.living_room_temp_target
        - input_number.living_room_temp_max_diff
        - input_number.living_room_temp_min_diff
    - trigger: state
      entity_id: input_boolean.living_room_window_mode
      to: "off"
    - trigger: time_pattern
      minutes: "/5"
      seconds: 3
    - trigger: homeassistant
      event: start
  conditions:
    - condition: state
      entity_id: input_select.season_mode
      state: "Winter"
      for:
        minutes: 20
  actions:
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.living_room_temp_low
              state: "on"
            - condition: state
              entity_id: switch.living_area_floor_heatings
              state: "on"
              for:
                hours: 1
            - condition: state
              entity_id: input_boolean.living_room_window_mode
              state: "off"
              for:
                hours: 1
            - not:
                - condition: state
                  entity_id: climate.living_room_ac
                  state: "heat"
            - not:
                - condition: state
                  entity_id: input_select.time_mode
                  state: "Midnight"
          sequence:
            - action: climate.set_temperature
              target:
                entity_id: climate.living_room_ac
              data:
                hvac_mode: "heat"
                temperature: "{{ int(states('input_number.living_room_temp_target')) }}"
            - action: notify.all_devices
              data:
                message: >-
                  Turned on Living Room AC Heat.
                  Current: {{ states('sensor.living_room_temperature') }}°C
                data:
                  push:
                    interruption-level: time-sensitive
                  url: "/lovelace/overview"
            - delay:
                hours: 2
        - conditions:
            - condition: state
              entity_id: binary_sensor.living_room_temp_high
              state: "on"
            - condition: state
              entity_id: climate.living_room_ac
              state: "heat"
          sequence:
            - action: climate.turn_off
              target:
                entity_id: climate.living_room_ac
            - action: notify.all_devices
              data:
                message: >-
                  Turned off Living Room AC Heat.
                  Current: {{ states('sensor.living_room_temperature') }}°C
                data:
                  push:
                    interruption-level: time-sensitive
                  url: "/lovelace/overview"
            - delay:
                hours: 2
  trace:
    stored_traces: 100
- id: automation.toggle_living_room_humidifier
  alias: "Toggle Living Room Humidifier"
  triggers:
    - trigger: state
      entity_id:
        - input_number.living_room_humidity_target
        - input_number.living_room_humidity_max_diff
        - input_number.living_room_humidity_min_diff
    - trigger: time_pattern
      minutes: "/5"
      seconds: 43
    - trigger: homeassistant
      event: start
  conditions:
    - or:
        - condition: state
          entity_id: input_select.season_mode
          state:
            - "Summer"
          for:
            minutes: 20
        - condition: state
          entity_id: input_select.season_mode
          state:
            - "Winter"
          for:
            minutes: 20
  actions:
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.living_room_humidity_low
              state: "on"
            - condition: state
              entity_id: switch.living_room_humidifier
              state: "off"
              for:
                hours: 1
            - not:
                - condition: state
                  entity_id: input_select.time_mode
                  state: "Midnight"
          sequence:
            - choose:
                - conditions:
                    - or:
                        - condition: state
                          entity_id: input_boolean.living_room_window_mode
                          state: "on"
                          for:
                            minutes: 10
                        - condition: state
                          entity_id: input_select.time_mode
                          state: "Late Night"
                  sequence:
                    - event: "living_room_humidity_too_low"
                - conditions:
                    - condition: state
                      entity_id: input_boolean.living_room_window_mode
                      state: "off"
                      for:
                        minutes: 10
                  sequence:
                    - action: switch.toggle
                      entity_id: switch.living_room_humidifier
                    - action: notify.all_devices
                      data:
                        message: >-
                          Turned on Living Room Humidifier.
                          Current: {{ states('sensor.living_room_humidity') }}%
                        data:
                          push:
                            interruption-level: time-sensitive
                          url: "/lovelace/overview"
                    - delay:
                        hours: 1
        - conditions:
            - condition: state
              entity_id: binary_sensor.living_room_humidity_high
              state: "on"
            - condition: state
              entity_id: switch.living_room_humidifier
              state: "on"
          sequence:
            - action: switch.toggle
              entity_id: switch.living_room_humidifier
            - action: notify.all_devices
              data:
                message: >-
                  Turned off Living Room Humidifier.
                  Current: {{ states('sensor.living_room_humidity') }}%
                data:
                  push:
                    interruption-level: time-sensitive
                  url: "/lovelace/overview"
            - delay:
                hours: 1
  trace:
    stored_traces: 100
- id: automation.turn_off_living_room_ac_internal_clean
  alias: "Turn Off Living Room AC Internal Clean"
  triggers:
    - trigger: state
      entity_id: climate.living_room_ac
      to: "fan_only"
      for:
        minutes: 120
    - trigger: state
      entity_id: climate.living_room_ac
      from: "fan_only"
      to: "off"
  actions:
    - action: climate.turn_off
      target:
        entity_id: climate.living_room_ac
    - action: automation.turn_off
      target:
        entity_id:
          - automation.turn_on_living_room_ac_internal_clean
  trace:
    stored_traces: 100
- id: automation.turn_off_living_room_climate_ventilated
  alias: "Turn off Living Room Climate Ventilated"
  triggers:
    - trigger: state
      entity_id: input_select.living_room_climate_mode
      to: "Ventilated"
  actions:
    - variables:
        acted: false
    - if:
        - condition: state
          entity_id: climate.living_room_ac
          state:
            - "cool"
            - "dry"
            - "heat"
      then:
        - action: climate.turn_off
          target:
            entity_id: climate.living_room_ac
        - variables:
            acted: true
    - if:
        - condition: state
          entity_id: switch.living_room_humidifier
          state: "on"
      then:
        - action: switch.turn_off
          target:
            entity_id: switch.living_room_humidifier
        - variables:
            acted: true
    - if:
        - "{{ acted }}"
      then:
        - action: notify.all_devices
          data:
            message: "Turned off Living Room Climate Systems Due to Ventilating"
            data:
              push:
                interruption-level: time-sensitive
              url: "/lovelace/overview"
  trace:
    stored_traces: 100
- id: automation.turn_on_living_room_ac_internal_clean
  alias: "Turn on Living Room AC Internal Clean"
  triggers:
    - trigger: state
      entity_id: climate.living_room_ac
      to: "off"
      for:
        seconds: 10
  actions:
    - action: climate.set_hvac_mode
      target:
        entity_id: climate.living_room_ac
      data:
        hvac_mode: "fan_only"
  trace:
    stored_traces: 100
- id: automation.toggle_living_room_fan
  alias: "Toggle Living Room Fan"
  triggers:
    - trigger: time_pattern
      minutes: "/5"
      seconds: 4
    - trigger: homeassistant
      event: start
  action:
    - choose:
        - conditions:
            - condition: numeric_state
              entity_id: sensor.study_motion_count
              above: 5
            - condition: state
              entity_id: fan.living_room_fan
              state: "off"
          sequence:
            - action: fan.turn_on
              target:
                entity_id: fan.living_room_fan
        - conditions:
            - condition: numeric_state
              entity_id: sensor.study_motion_count
              below: 5
            - condition: state
              entity_id: fan.living_room_fan
              state: "on"
          sequence:
            - action: fan.turn_off
              target:
                entity_id: fan.living_room_fan
  trace:
    stored_traces: 100
- id: automation.toggle_living_area_floor_heating
  alias: "Toggle Living Area Floor Heating"
  triggers:
    - trigger: state
      entity_id:
        - input_number.living_room_temp_target
        - input_number.living_room_temp_max_diff
        - input_number.living_room_temp_min_diff
    - trigger: state
      entity_id: input_boolean.living_room_window_mode
      to: "off"
    - trigger: time_pattern
      minutes: "/5"
      seconds: 11
    - trigger: homeassistant
      event: start
  conditions:
    - condition: state
      entity_id: input_select.season_mode
      state: "Winter"
      for:
        minutes: 20
  actions:
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.living_room_temp_low
              state: "on"
            - condition: state
              entity_id: switch.living_area_floor_heatings
              state: "off"
            - not:
                - condition: state
                  entity_id: input_select.time_mode
                  state: "Midnight"
          sequence:
            - choose:
                - conditions:
                    - or:
                        - condition: state
                          entity_id: input_boolean.living_room_window_mode
                          state: "on"
                          for:
                            minutes: 10
                        - condition: state
                          entity_id: input_select.time_mode
                          state: "Late Night"
                  sequence:
                    - event: "living_room_temp_too_low"
                - conditions:
                    - condition: state
                      entity_id: input_boolean.living_room_window_mode
                      state: "off"
                      for:
                        minutes: 10
                  sequence:
                    - action: switch.turn_on
                      target:
                        entity_id: switch.living_room_floor_heating
                    - action: switch.turn_on
                      target:
                        entity_id: switch.study_floor_heating
                    - action: notify.all_devices
                      data:
                        message: >-
                          Turned on Living Area Floor Heating.
                          Current: {{ states('sensor.living_room_temperature') }}°C
                        data:
                          push:
                            interruption-level: time-sensitive
                          url: "/lovelace/overview"
                    - delay:
                        hours: 2
        - conditions:
            - condition: state
              entity_id: binary_sensor.living_room_temp_high
              state: "on"
              for:
                hours: 1
            - condition: state
              entity_id: switch.living_area_floor_heatings
              state: "on"
              for:
                hours: 1
            - not:
                - condition: state
                  entity_id: alarm_control_panel.home
                  state: armed_vacation
          sequence:
            - action: switch.turn_off
              target:
                entity_id: switch.living_room_floor_heating
            - action: switch.turn_off
              target:
                entity_id: switch.study_floor_heating
            - action: notify.all_devices
              data:
                message: >-
                  Turned off Living Area Floor Heating.
                  Current: {{ states('sensor.living_room_temperature') }}°C
                data:
                  push:
                    interruption-level: time-sensitive
                  url: "/lovelace/overview"
            - delay:
                hours: 2
  trace:
    stored_traces: 100
