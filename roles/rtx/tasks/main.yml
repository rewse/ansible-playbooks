---
# - name: Set up SSH
#   do_it_yourself_rtx_config:
#     lines:
#       - login user username password
#       - sshd host key generate
#       - sshd service on

- name: Set login
  rtx_config:
    lines:
      - login timer clear
    save_when:
      changed
  tags: [rtx, rtx-login]

- name: Set security
  rtx_config:
    lines:
      - security class 2 on
    save_when:
      changed
  tags: [rtx, rtx-security]

- name: Set console
  rtx_config:
    lines:
      - console character ascii
      - console prompt romeo
    save_when:
      changed
  tags: [rtx, rtx-console]

- name: Set ip
  rtx_config:
    lines:
      - ip route default gateway 192.168.1.1
      - ip keepalive 1 icmp-echo 10 5 192.168.1.1
      - ip lan1 address dhcp
      - ip lan2 address 192.168.1.100/24
    save_when:
      changed
  tags: [rtx, rtx-ip]

- name: Set syslog
  rtx_config:
    lines:
      - syslog host 192.168.0.30
      - syslog execute command on
    save_when:
      changed
  tags: [rtx, rtx-syslog]

- name: Set dhcp
  rtx_config:
    lines:
      - dhcp client hostname lan2 primary rtx1200
    save_when:
      changed
  tags: [rtx, rtx-dhcp]

- name: Set dns
  rtx_config:
    lines:
      - dns server 1.1.1.1 8.8.8.8
      - dns server select 100 1.1.1.1 8.8.8.8 any .
    save_when:
      changed
  tags: [rtx, rtx-dns]

- name: Set schedule
  rtx_config:
    lines:
      - schedule at 100 */* 04:52:16 * ntpdate ntp.nict.jp syslog
    save_when:
      changed
  tags: [rtx, rtx-schedule]

- name: Get dhcpc
  rtx_command:
    commands:
      - show status dhcpc
  register: result_get_dhcpc
  tags: [rtx, rtx-ip, rtx-dhcp]

- name: Show dhcpc
  debug:
    msg: "{{ result_get_dhcpc.stdout_lines[0] }}"
  tags: [rtx, rtx-ip, rtx-dhcp]
