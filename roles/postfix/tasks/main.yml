---
- name: set inet_interfaces
  lineinfile:
    dest: /etc/postfix/main.cf
    insertafter: '^#inet_interfaces'
    regexp: '^inet_interfaces'
    line: 'inet_interfaces = all'
  notify: reload postfix
  tags: [postfix]

- name: set mydestination
  lineinfile:
    dest: /etc/postfix/main.cf
    insertbefore: '^#mydestination'
    regexp: '^mydestination'
    line: 'mydestination = $myhostname, localhost.$mydomain, localhost, $mydomain'
  notify: reload postfix
  tags: [postfix]

- name: set mail_spool_directory
  lineinfile:
    dest: /etc/postfix/main.cf
    insertafter: '^#mail_spool_directory'
    regexp: '^mail_spool_directory'
    line: 'mail_spool_directory= /srv/mail/'
  notify: reload postfix
  tags: [postfix]

- name: create user's dir for mail
  file:
    path: /srv/mail/{{admin}}
    state: directory
    owner: '{{admin}}'
    group: '{{admin}}'
    mode: 0700
  tags: [postfix]
