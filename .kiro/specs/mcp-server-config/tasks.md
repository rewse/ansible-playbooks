# 実装計画

- [x] 1. MCPサーバーロールの基本構造を作成する
  - roles/mcp-server ディレクトリとサブディレクトリ（tasks、templates、vars、handlers）を作成する
  - _要件: 1.1, 1.3_

- [ ] 2. MCPサーバー設定テンプレートを作成する
  - [x] 2.1 mcp.json.j2 テンプレートファイルを作成する
    - Jinja2テンプレート構文を使用して動的な設定ファイルを定義する
    - 変数から設定値を生成する機能を実装する
    - _要件: 2.1, 2.2_
  
  - [x] 2.2 共通のデフォルト変数を定義する
    - roles/mcp-server/vars/main.yml ファイルに共通のデフォルト設定を定義する
    - 設定ディレクトリと設定ファイルのパスを定義する
    - 基本的なMCPサーバー設定構造を定義する
    - _要件: 2.3, 2.4_
    
  - [x] 2.3 環境固有の変数を定義する
    - roles/mcp-server/vars/personal.yml ファイルに個人環境用の設定を定義する（mcp-server-personalタグで使用）
    - roles/mcp-server/vars/business.yml ファイルに業務環境用の設定を定義する（mcp-server-businessタグで使用）
    - 環境ごとに異なるMCPサーバー設定を定義する
    - _要件: 2.1, 2.2_

- [ ] 3. パッケージインストールタスクを実装する
  - [x] 3.1 install.yml タスクファイルを作成する
    - uv パッケージマネージャーのインストールタスクを実装する
    - uvx コマンドのインストールタスクを実装する
    - _要件: 4.1, 4.2, 4.3_
  
  - [x] 3.2 インストール検証タスクを実装する
    - インストールされたコマンドが正常に動作することを確認するタスクを実装する
    - _要件: 4.4_

- [ ] 4. 設定ファイル配置タスクを実装する
  - [x] 4.1 main.yml タスクファイルを作成する
    - パッケージインストールタスクをインクルードする
    - 設定ディレクトリ作成タスクを実装する
    - 設定ファイル配置タスクを実装する
    - _要件: 1.1, 1.2, 1.3, 1.4_
  
  - [x] 4.2 設定ファイル検証タスクを実装する
    - JSON構文の検証タスクを実装する
    - エラー処理を実装する
    - _要件: 3.1, 3.2_

- [ ] 5. シンボリックリンク作成タスクを実装する（必要に応じて）
  - 特定のツールが異なるパスで設定ファイルを探す場合のシンボリックリンク作成タスクを実装する
  - _要件: 1.5_

- [ ] 6. プレイブックにロールを統合する
  - [x] 6.1 darwin-personal.yml プレイブックにmcp-serverロールを追加する
    - 個人環境用の設定を適用するようにする
    - mcp-server-personalタグを設定する
    - _要件: 1.1, 2.2, 4.1_
  
  - [x] 6.2 darwin-business.yml プレイブックにmcp-serverロールを追加する
    - 業務環境用の設定を適用するようにする
    - mcp-server-businessタグを設定する
    - _要件: 1.1, 2.2, 4.1_

- [x] 7. テストを実装する
  - [x] 7.1 設定ファイル生成のテストを実装する
    - テンプレートから生成される設定ファイルが有効なJSONであることを確認する
    - _要件: 3.1_
  
  - [x] 7.2 パッケージインストールのテストを実装する
    - uvとuvxコマンドが正しくインストールされることを確認する
    - _要件: 4.4_
  
  - [x] 7.3 統合テストを実装する
    - プレイブックが正常に実行されることを確認する
    - 設定ファイルが正しい場所に配置されることを確認する
    - _要件: 1.1, 3.3_